<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Собрать ланч - LunchExpress</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/order.css">
    <link rel="stylesheet" href="styles/print.css" media="print">
    <style>
        /* Стили для сетки блюд (встроенные для надежности) */
        .dishes-section {
            margin-bottom: 40px;
        }

        .dishes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 40px;
        }

        .dish-card {
            display: flex;
            flex-direction: column;
            padding: 30px 40px;
            border-radius: 35px;
            cursor: pointer;
            filter: drop-shadow(17px 19px 24px rgba(0, 0, 0, 0.13));
            background-color: white;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .dish-card:hover {
            border-color: tomato;
        }

        .dish-card:hover .add-btn {
            background-color: tomato;
            color: white;
        }

        .dish-card.selected {
            border: 2px solid tomato;
        }

        .dish-card.selected .add-btn {
            background-color: tomato;
            color: white;
        }

        .dish-card img {
            width: 100%;
            border-radius: 35px;
            margin-bottom: 15px;
        }

        .dish-price {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .dish-name {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .dish-count {
            color: #666;
            margin-bottom: 15px;
        }

        .add-btn {
            background-color: #f1eee9;
            padding: 10px 30px;
            border-radius: 10px;
            cursor: pointer;
            border: none;
            font-family: 'Montserrat', sans-serif;
            font-size: 16px;
            margin-top: auto;
            transition: all 0.3s ease;
        }

        /* Адаптивность */
        @media (max-width: 800px) {
            .dishes-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .dish-card {
                padding: 20px 25px;
            }
        }

        @media (max-width: 600px) {
            .dishes-grid {
                grid-template-columns: 1fr;
            }
            .dish-card {
                padding: 15px 20px;
            }
        }

        @media (max-width: 400px) {
            .order-category h3 {
                font-size: 16px;
            }
            .selected-item {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <h1>LunchExpress</h1>
                <nav>
                    <ul class="nav-flex">
                        <li><a href="index.html">Главная</a></li>
                        <li><a href="build-lunch.html" class="active">Собрать ланч</a></li>
                        <li><a href="index.html#feedback">Обратная связь</a></li>
                        <li><a href="index.html#auth">Вход</a></li>
                        <li><a href="index.html#contacts">Контакты</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Секции с блюдами (будут заполнены JavaScript) -->
        <section id="soup-section" class="dishes-section">
            <h2>Супы</h2>
            <div class="dishes-grid">
                <!-- Карточки супов будут созданы динамически -->
            </div>
        </section>

        <section id="main-section" class="dishes-section">
            <h2>Главные блюда</h2>
            <div class="dishes-grid">
                <!-- Карточки главных блюд будут созданы динамически -->
            </div>
        </section>

        <section id="drink-section" class="dishes-section">
            <h2>Напитки</h2>
            <div class="dishes-grid">
                <!-- Карточки напитков будут созданы динамически -->
            </div>
        </section>
        <!-- Блок с комбо-предложениями -->
        <section id="combo-section" class="combo-section">
            <h2>Готовые варианты ланча</h2>
            <div class="combo-grid">
                <!-- Классический ланч -->
                <div class="combo-option">
                    <h3>Классический</h3>
                    <div class="combo-dishes">
                        <div class="combo-dish">
                            <img src="images/combo_soup_classic.jpg" alt="Куриный суп с лапшой">
                            <p class="combo-dish-label">Куриный суп с лапшой</p>
                        </div>
                        <div class="combo-dish">
                            <img src="images/combo_main_classic.jpg" alt="Курица терияки с рисом">
                            <p class="combo-dish-label">Курица терияки с рисом</p>
                        </div>
                        <div class="combo-dish">
                            <img src="images/combo_drink_classic.jpg" alt="Морс клюквенный">
                            <p class="combo-dish-label">Морс клюквенный</p>
                        </div>
                    </div>
                    <p class="combo-price">780 руб.</p>
                    <p class="combo-description">Сытный традиционный обед</p>
                </div>
        
                <!-- Рыбный ланч -->
                <div class="combo-option">
                    <h3>Рыбный</h3>
                    <div class="combo-dishes">
                        <div class="combo-dish">
                            <img src="images/combo_soup_fish.jpg" alt="Уха по-фински">
                            <p class="combo-dish-label">Уха по-фински</p>
                        </div>
                        <div class="combo-dish">
                            <img src="images/combo_main_fish.jpg" alt="Лосось на гриле">
                            <p class="combo-dish-label">Лосось на гриле</p>
                        </div>
                        <div class="combo-dish">
                            <img src="images/combo_drink_fish.jpg" alt="Апельсиновый сок">
                            <p class="combo-dish-label">Апельсиновый сок</p>
                        </div>
                    </div>
                    <p class="combo-price">930 руб.</p>
                    <p class="combo-description">Для любителей морепродуктов</p>
                </div>
        
                <!-- Вегетарианский ланч -->
                <div class="combo-option">
                    <h3>Вегетарианский</h3>
                    <div class="combo-dishes">
                        <div class="combo-dish">
                            <img src="images/combo_soup_veg.jpg" alt="Грибной крем-суп">
                            <p class="combo-dish-label">Грибной крем-суп</p>
                        </div>
                        <div class="combo-dish">
                            <img src="images/combo_main_veg.jpg" alt="Овощное рагу">
                            <p class="combo-dish-label">Овощное рагу</p>
                        </div>
                        <div class="combo-dish">
                            <img src="images/combo_drink_veg.jpg" alt="Лимонад мятный">
                            <p class="combo-dish-label">Лимонад мятный</p>
                        </div>
                    </div>
                    <p class="combo-price">730 руб.</p>
                    <p class="combo-description">Без мяса, но очень вкусно</p>
                </div>
            </div>
        
            <div class="dessert-note">
                <p><strong>Десерты можно добавить к любому ланчу за дополнительную плату.</strong></p>
                <p class="small-text">Выберите десерт из раздела выше и добавьте к заказу</p>
            </div>
        </section>

        <!-- Раздел "Ваш заказ" (создается JavaScript) -->
        <div id="order-summary"></div>

        <!-- Форма оформления заказа -->
        <section class="order-form-section">
            <h2>Оформление заказа</h2>
            <form id="order-form" action="https://httpbin.org/post" method="post">
                <!-- Скрытые поля для выбранных блюд -->
                <input type="hidden" id="soup-input" name="soup">
                <input type="hidden" id="main-input" name="main">
                <input type="hidden" id="drink-input" name="drink">

                <div class="form-row">
                    <div class="form-group half">
                        <label for="customer-name">Ваше имя *</label>
                        <input type="text" id="customer-name" name="customer_name" required>
                    </div>
                    <div class="form-group half">
                        <label for="customer-phone">Телефон *</label>
                        <input type="tel" id="customer-phone" name="customer_phone" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="delivery-address">Адрес доставки *</label>
                    <input type="text" id="delivery-address" name="delivery_address" required>
                </div>

                <div class="form-group">
                    <label for="delivery-time">Время доставки</label>
                    <select id="delivery-time" name="delivery_time">
                        <option value="12:00-13:00">12:00 - 13:00</option>
                        <option value="13:00-14:00" selected>13:00 - 14:00</option>
                        <option value="14:00-15:00">14:00 - 15:00</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="comments">Комментарий к заказу</label>
                    <textarea id="comments" name="comments" rows="3"></textarea>
                </div>

                <button type="submit" class="submit-order-btn">Оформить заказ</button>
            </form>
        </section>
    </main>

    <footer id="contacts">
        <div class="container">
            <div class="footer-content">
                <div class="contact-info">
                    <h3>Контакты</h3>
                    <p>Адрес: г. Москва, ул. Промышленная, д. 15</p>
                    <p>Телефон: <a href="tel:+74951234567">+7 (495) 123-45-67</a></p>
                    <p>Email: <a href="mailto:info@lunchexpress.ru">info@lunchexpress.ru</a></p>
                    <p>Время работы: Пн-Пт с 9:00 до 18:00</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Подключение JavaScript -->
    <script>
        // Динамическое создание блюд и управление заказом
        document.addEventListener('DOMContentLoaded', function() {
            // Массив блюд (можно вынести в отдельный файл)
            const dishes = [
                // Супы
                {
                    keyword: "chicken_noodle_soup",
                    name: "Куриный суп с лапшой",
                    price: 250,
                    category: "soup",
                    count: "350 г",
                    image: "images/soup1.jpg"
                },
                {
                    keyword: "mushroom_cream_soup",
                    name: "Грибной крем-суп",
                    price: 280,
                    category: "soup",
                    count: "300 г",
                    image: "images/soup2.jpg"
                },
                {
                    keyword: "tomato_basil_soup",
                    name: "Томатный суп с базиликом",
                    price: 270,
                    category: "soup",
                    count: "320 г",
                    image: "images/soup3.jpg"
                },

                // Главные блюда
                {
                    keyword: "teriyaki_chicken_rice",
                    name: "Курица терияки с рисом",
                    price: 380,
                    category: "main",
                    count: "400 г",
                    image: "images/main1.jpg"
                },
                {
                    keyword: "grilled_salmon_vegetables",
                    name: "Лосось на гриле с овощами",
                    price: 450,
                    category: "main",
                    count: "350 г",
                    image: "images/main2.jpg"
                },
                {
                    keyword: "pasta_carbonara",
                    name: "Паста Карбонара",
                    price: 350,
                    category: "main",
                    count: "350 г",
                    image: "images/main3.jpg"
                },

                // Напитки
                {
                    keyword: "cranberry_juice",
                    name: "Морс клюквенный",
                    price: 150,
                    category: "drink",
                    count: "330 мл",
                    image: "images/drink1.jpg"
                },
                {
                    keyword: "mint_lemonade",
                    name: "Лимонад мятный",
                    price: 180,
                    category: "drink",
                    count: "500 мл",
                    image: "images/drink2.jpg"
                },
                {
                    keyword: "coffee_latte",
                    name: "Кофе латте",
                    price: 200,
                    category: "drink",
                    count: "300 мл",
                    image: "images/drink3.jpg"
                },
            ];

            // Выбранные блюда
            let selectedDishes = {
                soup: null,
                main: null,
                drink: null
            };

            // Инициализация
            initDishCards();
            initOrderSection();

            // Создание карточек блюд
            function initDishCards() {
                // Сортируем блюда по алфавиту
                dishes.sort((a, b) => a.name.localeCompare(b.name, 'ru'));

                // Группируем по категориям
                const categories = {
                    soup: dishes.filter(dish => dish.category === 'soup'),
                    main: dishes.filter(dish => dish.category === 'main'),
                    drink: dishes.filter(dish => dish.category === 'drink')
                };

                // Создаем карточки для каждой категории
                Object.keys(categories).forEach(category => {
                    const section = document.querySelector(`#${category}-section .dishes-grid`);
                    if (!section) return;

                    section.innerHTML = '';

                    categories[category].forEach(dish => {
                        const card = document.createElement('div');
                        card.className = 'dish-card';
                        card.setAttribute('data-dish', dish.keyword);

                        card.innerHTML = `
                            <img src="${dish.image}" alt="${dish.name}" onerror="this.src='images/placeholder.jpg'">
                            <p class="dish-price">${dish.price} руб.</p>
                            <p class="dish-name">${dish.name}</p>
                            <p class="dish-count">${dish.count}</p>
                            <button class="add-btn" type="button">Добавить</button>
                        `;

                        // Обработчик клика
                        card.querySelector('.add-btn').addEventListener('click', function(e) {
                            e.stopPropagation();
                            selectDish(dish);
                        });

                        section.appendChild(card);
                    });
                });
            }

            // Инициализация раздела заказа
            function initOrderSection() {
                const orderHTML = `
                    <div class="order-section">
                        <h2>Ваш заказ</h2>
                        <div id="order-items">
                            <div class="order-category" id="soup-category" style="display: none;">
                                <h3>Суп</h3>
                                <p class="empty-message">Блюдо не выбрано</p>
                                <div class="selected-item">
                                    <span class="item-name"></span>
                                    <span class="item-price"></span>
                                </div>
                            </div>
                            <div class="order-category" id="main-category" style="display: none;">
                                <h3>Основное блюдо</h3>
                                <p class="empty-message">Блюдо не выбрано</p>
                                <div class="selected-item">
                                    <span class="item-name"></span>
                                    <span class="item-price"></span>
                                </div>
                            </div>
                            <div class="order-category" id="drink-category" style="display: none;">
                                <h3>Напиток</h3>
                                <p class="empty-message">Напиток не выбран</p>
                                <div class="selected-item">
                                    <span class="item-name"></span>
                                    <span class="item-price"></span>
                                </div>
                            </div>
                            <div id="nothing-selected" style="text-align: center; padding: 20px; color: #888; font-style: italic;">
                                Ничего не выбрано
                            </div>
                        </div>
                        <div id="order-total" style="display: none;">
                            <div class="total-line"></div>
                            <div class="total-price">
                                <span>Стоимость заказа:</span>
                                <span id="total-amount">0 руб.</span>
                            </div>
                        </div>
                    </div>
                `;

                const orderSummary = document.getElementById('order-summary');
                orderSummary.innerHTML = orderHTML;

                updateOrderDisplay();
            }

            // Выбор блюда
            function selectDish(dish) {
                // Снимаем выделение со всех карточек
                document.querySelectorAll('.dish-card').forEach(card => {
                    card.classList.remove('selected');
                });

                // Выделяем выбранную
                const selectedCard = document.querySelector(`[data-dish="${dish.keyword}"]`);
                if (selectedCard) {
                    selectedCard.classList.add('selected');
                }

                // Сохраняем выбор
                selectedDishes[dish.category] = dish;

                // Обновляем отображение
                updateOrderDisplay();
                updateHiddenFields();
            }

            // Обновление отображения заказа
            function updateOrderDisplay() {
                const categories = ['soup', 'main', 'drink'];
                let hasSelectedItems = false;
                let totalAmount = 0;

                // Показываем/скрываем категории
                categories.forEach(category => {
                    const categoryElem = document.getElementById(`${category}-category`);
                    const dish = selectedDishes[category];

                    if (dish) {
                        hasSelectedItems = true;
                        categoryElem.style.display = 'block';

                        // Обновляем информацию о блюде
                        const itemName = categoryElem.querySelector('.item-name');
                        const itemPrice = categoryElem.querySelector('.item-price');
                        const emptyMessage = categoryElem.querySelector('.empty-message');

                        if (itemName) itemName.textContent = dish.name;
                        if (itemPrice) itemPrice.textContent = `${dish.price} руб.`;
                        if (emptyMessage) emptyMessage.style.display = 'none';
                        categoryElem.querySelector('.selected-item').style.display = 'flex';

                        totalAmount += dish.price;
                    } else if (hasSelectedItems) {
                        // Если есть другие выбранные блюда, показываем категорию
                        categoryElem.style.display = 'block';
                        categoryElem.querySelector('.empty-message').style.display = 'block';
                        categoryElem.querySelector('.selected-item').style.display = 'none';
                    } else {
                        categoryElem.style.display = 'none';
                    }
                });

                // Показываем/скрываем "Ничего не выбрано"
                document.getElementById('nothing-selected').style.display =
                    hasSelectedItems ? 'none' : 'block';

                // Обновляем общую стоимость
                const orderTotal = document.getElementById('order-total');
                const totalAmountElem = document.getElementById('total-amount');

                if (hasSelectedItems) {
                    orderTotal.style.display = 'block';
                    totalAmountElem.textContent = `${totalAmount} руб.`;
                } else {
                    orderTotal.style.display = 'none';
                }
            }

            // Обновление скрытых полей формы
            function updateHiddenFields() {
                const categories = ['soup', 'main', 'drink'];

                categories.forEach(category => {
                    const input = document.getElementById(`${category}-input`);
                    const dish = selectedDishes[category];
                    input.value = dish ? dish.keyword : '';
                });
            }

            // Обработчик отправки формы
            document.getElementById('order-form').addEventListener('submit', function(e) {
                const allSelected = selectedDishes.soup && selectedDishes.main && selectedDishes.drink;

                if (!allSelected) {
                    e.preventDefault();
                    alert('Пожалуйста, выберите блюда из всех категорий перед оформлением заказа.');
                    return false;
                }

                return true;
            });
        });
    </script>
</body>
</html>
